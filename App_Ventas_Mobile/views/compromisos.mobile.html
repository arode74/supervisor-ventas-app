<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Compromiso ‚Äî M√≥vil</title>

  <link rel="stylesheet" href="/styles/mobile-afp.css"/>
  <link rel="stylesheet" href="/styles/mobile.css"/>

  <!-- Config en ra√≠z (seg√∫n tu estructura) -->
  <script src="/config.js"></script>

  <style>
    /* Ajustes puntuales solicitados */
    .cmp-name{font-size:14px;font-weight:900;line-height:1.1}
    .cmp-kpi{font-size:12px;font-weight:800;opacity:.9;display:flex;gap:10px;flex-wrap:wrap}
    .cmp-card{padding:10px 12px;border-bottom:1px solid rgba(0,0,0,.06)}
    .cmp-card-top{display:flex;align-items:flex-start;gap:10px}
    .cmp-edit{margin-left:auto;border:0;border-radius:10px;padding:6px 10px;font-weight:900}
    .cmp-progress{margin-top:8px;height:10px;border-radius:999px;background:rgba(0,0,0,.08);position:relative;overflow:hidden}
    .cmp-bar{height:100%}
    .cmp-pct{position:absolute;right:8px;top:-18px;font-size:11px;font-weight:900;opacity:.8}

    /* Modal bottom sheet (simple y estable) */
    #overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:999}
    #sheet{position:fixed;left:0;right:0;bottom:0;transform:translateY(110%);transition:transform .18s ease;background:#fff;border-top-left-radius:18px;border-top-right-radius:18px;z-index:1000;max-height:86vh;overflow:auto}
    #sheet .grab{width:44px;height:5px;border-radius:99px;background:rgba(0,0,0,.15);margin:10px auto}
    #sheet .sheetHeader{padding:0 14px 10px}
    #sheet .sheetTitle{font-size:15px;font-weight:900}
    #sheet .sheetSub{font-size:12px;font-weight:800;opacity:.75;margin-top:2px}
    #sheet .tabs{display:flex;gap:8px;padding:0 14px 10px}
    #sheet .tab{flex:1;border:0;border-radius:12px;padding:10px 8px;font-weight:900}
    #sheet .tab.active{outline:2px solid rgba(0,0,0,.08)}
    #sheet .sheetBody{padding:0 14px 12px}
    #sheet .cmp-tr{display:grid;grid-template-columns:1.2fr .9fr 1fr;gap:10px;align-items:center;padding:8px 0;border-bottom:1px solid rgba(0,0,0,.06)}
    #sheet .cmp-th{font-size:12px;font-weight:900;opacity:.7}
    #sheet .cmp-tag{font-size:12px;font-weight:900}
    #sheet .cmp-cell input{width:100%;padding:8px;border-radius:10px;border:1px solid rgba(0,0,0,.15);font-weight:900}
    #sheet .diarioTop{display:flex;align-items:center;gap:10px;margin:8px 0 10px}
    #sheet .diarioTop .sp{margin-left:auto;display:flex;gap:8px}
    #sheet .navbtn{border:0;border-radius:10px;padding:8px 10px;font-weight:900}
    #sheet .cmp-drow{padding:10px 0;border-bottom:1px solid rgba(0,0,0,.06)}
    #sheet .cmp-dtop{display:flex;gap:10px;align-items:center}
    #sheet .cmp-dname{font-weight:900}
    #sheet .cmp-damt{margin-left:auto;width:110px;padding:8px;border-radius:10px;border:1px solid rgba(0,0,0,.15);font-weight:900;text-align:right}
    #sheet .cmp-dcom{width:100%;padding:8px;border-radius:10px;border:1px solid rgba(0,0,0,.15);font-weight:700}
    #sheet .cmp-char-counter{font-size:11px;font-weight:900;opacity:.7;margin-top:6px}
    #sheet .sheetFooter{display:flex;gap:10px;padding:10px 14px 14px}
    #sheet .btn{flex:1;border:0;border-radius:12px;padding:12px 10px;font-weight:900}
    #toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:rgba(0,0,0,.85);color:#fff;padding:10px 12px;border-radius:12px;font-weight:900;opacity:0;transition:opacity .15s;z-index:2000}
  </style>
</head>

<body>
  <div class="ventas-screen">

    <header class="m-topbar">
      <img class="m-topbar__logo" src="/assets/logo_app_ventas.png" alt="APP Ventas"/>
      <div class="m-topbar__title">Compromisos</div>
      <button class="m-topbar__logout" id="btn-logout" type="button" aria-label="Cerrar sesi√≥n" title="Cerrar sesi√≥n">‚èª</button>
    </header>

    <div class="ventas-top">
      <div class="m-toolbar">
        <div class="m-field">
          <div class="m-field__icon">üìÖ</div>
          <input class="m-input" id="dt-dia" type="date"/>
        </div>

        <div class="m-toolbar__right">
          <button class="m-backbtn" type="button" id="btn-volver">‚Äπ Volver</button>
        </div>
      </div>

      <div class="m-field m-gap-10">
        <div class="m-field__icon">üîé</div>
        <input class="m-input" id="txt-buscar" type="search" placeholder="Buscar vendedor‚Ä¶" autocomplete="off"/>
      </div>
    </div>

    <!-- SOLO ESTE BLOQUE SCROLLEA -->
    <main class="ventas-scroll">
      <section class="ventas-layout">
        <aside id="abcBar" class="ventas-abc" aria-label="√çndice alfab√©tico"></aside>

        <section class="m-card ventas-lista" aria-label="Lista de vendedores">
          <div class="m-list" id="lista-vendedores"></div>
        </section>
      </section>
    </main>

    <!-- Modal -->
    <div id="overlay"></div>
    <div id="sheet" role="dialog" aria-modal="true" aria-label="Editar compromisos">
      <div class="grab"></div>

      <div class="sheetHeader">
        <div class="sheetTitle">Editar</div>
        <div class="sheetSub" id="modalSub"></div>
      </div>

      <div class="tabs">
        <button class="tab active" id="tabMensual" type="button">Mensual</button>
        <button class="tab" id="tabSemanal" type="button">Semanal</button>
        <button class="tab" id="tabDiario" type="button">Diario</button>
      </div>

      <div class="sheetBody">
        <div id="formMensual">
          <div id="tblMensual"></div>
        </div>

        <div id="formSemanal" style="display:none">
          <div id="tblSemanal"></div>
        </div>

        <div id="formDiario" style="display:none">
          <div class="diarioTop">
            <div style="font-weight:900" id="diaLabel"></div>
            <div style="font-size:12px;font-weight:900;opacity:.75" id="lblSemana"></div>
            <div class="sp">
              <button class="navbtn" id="diaPrev" type="button">‚Äπ</button>
              <button class="navbtn" id="diaNext" type="button">‚Ä∫</button>
              <button class="navbtn" id="diarioAdd" type="button">Ôºã</button>
            </div>
          </div>
          <div id="diarioLista"></div>

          <div id="diarioPicker" style="display:none;margin-top:10px">
            <select id="diarioTipoSelect" class="m-input"></select>
            <div style="display:flex;gap:10px;margin-top:10px">
              <button class="btn" id="diarioTipoOk" type="button">OK</button>
              <button class="btn" id="diarioTipoCancel" type="button">Cancelar</button>
            </div>
          </div>
        </div>
      </div>

      <div class="sheetFooter">
        <button class="btn" id="btnCancelar" type="button">Cerrar</button>
        <button class="btn" id="btnGuardar" type="button" style="display:none">Guardar</button>
        <button class="btn" id="btnCerrar" type="button" style="display:none">Listo</button>
      </div>
    </div>

    <div id="toast"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/scripts/mobile_shared.js"></script>
    <script src="/scripts/compromiso_mobile.js" defer></script>

  </div>
</body>
</html>
